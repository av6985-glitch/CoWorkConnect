<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard | CoWorkConnect</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>

<script>
    const session = JSON.parse(localStorage.getItem("session"))

    if (!session || !session.isAdmin) {
        window.location.href = "login.html"
    }
</script>

<header>
    <h2 style="color: white; margin-left: 20px;">CoWorkConnect: Admin Panel</h2>
    <button onclick="app.auth.logout()">Logout</button>
</header>

<section>
    <h3>Add Workspace</h3>

    <input id="wsName" placeholder="Workspace Name">
    <input id="wsPrice" placeholder="Price per hour">

    <button onclick="
        app.admin.addWorkspace(
            document.getElementById('wsName').value,
            document.getElementById('wsPrice').value
        )
        loadAdminData()
    ">Add Workspace</button>
</section>

<section>
    <h3>Available Workspaces</h3>
    <ul id="workspaceList"></ul>
</section>

<section>
    <h3>All Bookings</h3>
    <ul id="adminBookingList"></ul>
</section>

<script type="module" src="js/app.js"></script>

<script>
// dynamic load and refresh functions
function loadAdminData() {

    // ==== WORKSPACES ====
    const workspaces = app.admin.getAllWorkspaces()
    const wsList = document.getElementById("workspaceList")
    wsList.innerHTML = ""

    workspaces.forEach(ws => {
        const li = document.createElement("li")
        li.textContent = `${ws.name} - $${ws.price}`
        wsList.appendChild(li)
    })

    // ==== BOOKINGS ====
    const bookings = app.booking.getAllBookings()
    const adminList = document.getElementById("adminBookingList")
    adminList.innerHTML = ""

    bookings.forEach(b => {
        const li = document.createElement("li")
        li.textContent = `${b.workspaceName} booked by ${b.userName} (${b.status || "Confirmed"})`

        const cancelBtn = document.createElement("button")
        cancelBtn.className = "cancelBtn"
        cancelBtn.textContent = "Cancel"
        cancelBtn.onclick = () => {
            app.booking.cancelBooking(b.id)
            loadAdminData()
        }

        li.appendChild(cancelBtn)
        adminList.appendChild(li)
    })
}

// load when ready
document.addEventListener("DOMContentLoaded", loadAdminData)
</script>

</body>
</html>
